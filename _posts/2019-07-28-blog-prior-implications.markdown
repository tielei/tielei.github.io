---
layout: post
category: "other"
title: "用统计学的观点看世界：从找不到东西说起"
date: 2019-07-28 00:00:00 +0800
published: true
---

在家里，妻子总是埋怨我找不到东西。于是我辩称，很多东西并不是我放的，找不到很正常啊。每当这个时候，她总是一脸不屑地说，很多东西也不是她放的，但为什么她很快就能找到？

<!--more-->

我回想了一下，事实似乎真的如此。不管是孩子的日常衣物、水杯文具，还是常年不用的证照、文件之类，她总能快速地把它翻找出来。按她的说法，你自己“扒拉扒拉”不就找到了吗？

根据我惯常的程序员思维，这种到处“扒拉扒拉”找东西的方式，属于最原始的遍历搜索，应该很低效才对啊。其实在房间里找东西，有点类似于在一大堆数据中查找你想要的那份数据，要想效率高，怎么着也得建个索引吧。但家里显然不存在这么一个「索引」。

妻子找东西似乎是依靠着某种直觉的。这不太科学。

直到有一天，我在维基百科上发现了一个统计学理论，才豁然开朗。这个理论叫做**贝叶斯搜索理论** ([Bayesian search theory](https://en.wikipedia.org/wiki/Bayesian_search_theory){:target="_blank"})[1]，恰好是一个关于「如何找东西」的理论。当然，它并没有直接告诉我们如何在房间里找东西，而是给出了一套统计学方法，在实际中经常应用在「失物搜索」领域，比如在海面上打捞沉船或者飞机残骸等等。

这个理论是1966年被美国海军的一位科学家发明出来的。

当时正值冷战期间。美国空军的一架B-52G轰炸机，携带了四枚氢弹，在西班牙海岸外的地中海上空执行一个例行的飞行活动。谁也没有想到，轰炸机在空中加油时竟与加油机相撞，结果飞机解体，那四枚氢弹也自然不知所踪。其中的三枚氢弹很快就被搜索小组找到了，但第四枚始终下落不明。

为了寻找第四枚氢弹，美国海军派出了一个技术援助小组。小组成员中就包含这位科学家——[约翰·克雷文](https://en.wikipedia.org/wiki/John_P._Craven){:target="_blank"}博士[2]。想象一下当时的情景：这第四枚失踪的氢弹，肯定是落到了一个出人意料的地方，否则它早就像前三枚氢弹一样被找到了。但可能性实在太多了，它可能落到了西班牙海岸边某个地方，也可能落到了地中海广阔的水域中。总之，寻找氢弹的任务如同大海捞针，看起来根本无从下手。

但约翰·克雷文独辟蹊径，依据**贝叶斯推断** ([Bayesian inference](https://en.wikipedia.org/wiki/Bayesian_inference){:target="_blank"})[3]的数学原理，发明出了贝叶斯搜索理论这一套方法，并在这个理论的指导下成功找到了第四枚氢弹。

这一套方法后来又曾多次在海上搜救中派上用场。比如，1968年美国海军寻找[失联的核潜艇](https://en.wikipedia.org/wiki/USS_Scorpion_%28SSN-589%29){:target="_blank"}[4]，2009年[法航447航班空难](https://en.wikipedia.org/wiki/Air_France_Flight_447){:target="_blank"}后寻找黑匣子[5]，都是依靠这套方法。没错，2014年的[马航370失联](https://en.wikipedia.org/wiki/Malaysia_Airlines_Flight_370){:target="_blank"}后的搜救工作[6]，也使用了这套方法（但不幸没有找到）。

这个**贝叶斯搜索理论**听起来似乎有些神奇，那它到底是怎么做的呢？

实际上，它的关键在于能够将不确定的信息，包括根据经验做出的各种猜测，都用数字化的方式量化出来，并根据搜索过程中的阶段性成果不断地对这些数字进行修正。为了理解这个理论的细节，我们需要一点点概率论的知识作为铺垫。因此，现在我们先不过早地深入到这些细节中去，而是先来讲一个看似无关的小故事，然后我们再回过头来看这个理论。

### 一个关于决策和可信度的小故事

假设有一家公司，由于市场环境的变化，亟待进行业务转型。如果转型失败，公司就面临倒闭。

现在假设你临危受命，被董事会任命为公司的CEO，来领导公司的转型。经过多方调研以及与公司同事们的讨论，你发现有一个新的业务方向值得去尝试。但是，向这个新业务的转型需要巨额的前期投资。接着你发现，根据公司目前的财务状况，你只能一次性成功，根本没有试错的机会。也就是说，如果选错了投入的方向，那么公司最后的资本就会耗尽，也就彻底没有翻盘的机会了。所以，你现在需要做一个决策：到底要不要投入这个新业务？

这个决策责任重大，你自己也有点拿不准。于是，你找来了公司核心的两位元老 (A和B)，打算听取他们的意见。

很不幸，A和B对于新的业务方向意见不同。A比较乐观，而B比较保守。他们分别做出了如下的论断：

* *R*<sub>*A*</sub>: 公司有九成的把握可以在新业务上取得成功；
* *R*<sub>*B*</sub>: 公司只有三成的把握可以在新业务上取得成功；

这时候你迫切地想知道谁的论断更准确一点，更接近实际情况。但是，由于你刚来公司不久，以前跟A和B从来没有共事过，所以你对于他们谁说的话更靠谱完全没有任何信息。把这个情况定量地表达出来，你可以说，A和B做出的两个论断可信度都是50%。这个可信度可以用概率表示出来，如下：

* *P*(*R*<sub>*A*</sub>) = 0.5
* *P*(*R*<sub>*B*</sub>) = 0.5

这样呢，公司在新业务上转型成功和失败的概率，针对A和B的两个论断，可以分别表达成条件概率的形式：

* *P*(转型成功\|*R*<sub>*A*</sub>) = 0.9
* *P*(转型失败\|*R*<sub>*A*</sub>) = 1 - 0.9 = 0.1
* *P*(转型成功\|*R*<sub>*B*</sub>) = 0.3
* *P*(转型失败\|*R*<sub>*B*</sub>) = 1 - 0.3 = 0.7

所谓兼听则明，偏信则暗，于是你想综合考虑一下两个人的论断，通过计算来确定公司转型成功和失败的概率最终分别是多少。这需要使用**全概率公式**([Law of total probability](https://en.wikipedia.org/wiki/Law_of_total_probability){:target="_blank"})[7]：

* *P*(转型成功) = *P*(转型成功\|*R*<sub>*A*</sub>) * *P*(*R*<sub>*A*</sub>) + *P*(转型成功\|*R*<sub>*B*</sub>) * *P*(*R*<sub>*B*</sub>) = 0.6
* *P*(转型失败) = *P*(转型失败\|*R*<sub>*A*</sub>) * *P*(*R*<sub>*A*</sub>) + *P*(转型失败\|*R*<sub>*B*</sub>) * *P*(*R*<sub>*B*</sub>) = 0.4

好了，现在你得到了一个结论：公司在这个新业务上转型成功的可能性是60%，不算太高，但总比50%要高。你没有找到更好的方向可供选择，所以决定放手一搏，驱动整个公司进行转型。

一年后，毫无疑问，你会得到两个结果中的一个：转型成功了，或者，转型失败了。

先考虑转型失败的情况，这时候公司的钱花光了，面临倒闭。但是，你想吸取教训，对决策过程进行一下复盘。基于现在最新的结果（转型失败了），你可以重新计算当初A和B的两个论断的可信度，这需要用到**贝叶斯定理**([Bayes' theorem](https://en.wikipedia.org/wiki/Bayes%27_theorem){:target="_blank"})[8]：

* *P*(*R*<sub>*A*</sub>\|转型失败) = *P*(转型失败\|*R*<sub>*A*</sub>) * *P*(*R*<sub>*A*</sub>) / *P*(转型失败) = 0.125
* *P*(*R*<sub>*B*</sub>\|转型失败) = *P*(转型失败\|*R*<sub>*B*</sub>) * *P*(*R*<sub>*B*</sub>) / *P*(转型失败) = 0.875

这两个式子的意思是说，根据现在转型失败这一客观事实，你修正了当初两个论断的可信度。它们不再是分别50%了，而是A的论断的可信度急剧降低，变成了12.5%，而B的论断的可信度升高到87.5%。这里可能有人会说，现在转型失败已经是确凿的事实了，为什么A的论断的可信度没有降低到零啊？这个倒也很好理解，因为A并没有说转型会100%成功。就算A的论断完全符合实际，公司仍有10%的概率会转型失败。但是不管怎么说，从概率上判断，我们可以认为，A说的话没有那么靠谱了。这可能会促使你对A产生一个很不好的印象，也许你以后再也不想跟A一起玩了。

再来考虑一下转型成功的情况。这时候公司找到了新的业务方向，前景一片光明。你同样想对决策过程进行一下复盘。基于现在最新的结果（转型成功了），你重新计算了当初A和B的两个论断的可信度（还是基于**贝叶斯定理**）：

* *P*(*R*<sub>*A*</sub>\|转型成功) = *P*(转型成功\|*R*<sub>*A*</sub>) * *P*(*R*<sub>*A*</sub>) / *P*(转型成功) = 0.75
* *P*(*R*<sub>*B*</sub>\|转型成功) = *P*(转型成功\|*R*<sub>*B*</sub>) * *P*(*R*<sub>*B*</sub>) / *P*(转型成功) = 0.25

这意味着，在你心目中，A的靠谱程度升高到75%，而B的靠谱程度降低到25%。假设后来公司又有新的决策需要制定，而A和B又给出了不同的论断，分别记为：

* *S*<sub>*A*</sub>
* *S*<sub>*B*</sub>

那么这一次，你可以把上一次对A和B论断的可信度的最新估计，当做初始的可信度估计，即：

* *P*(*S*<sub>*A*</sub>) = 0.75
* *P*(*S*<sub>*B*</sub>) = 0.25

然后，你就可以像上次决策过程一样，进行新一轮的计算评估了。并且，在决策的结果出来后，可以继续调整对于A和B论断的可信度的估计。

### 贝叶斯学派和频率学派

古典概型

### 回到贝叶斯搜索理论


当我失去索引，茫然无措的时候，妻子的做法反而把握了。



这也正是为什么一般编程手段解决不了的，机器学习却可以。它有一定的反脆弱性。

概率是个冒险的东西



（完）

##### 参考文献：

* [1] <https://en.wikipedia.org/wiki/Bayesian_search_theory>{:target="_blank"}
* [2] <https://en.wikipedia.org/wiki/John_P._Craven>{:target="_blank"}
* [3] <https://en.wikipedia.org/wiki/Bayesian_inference>{:target="_blank"}
* [4] <https://en.wikipedia.org/wiki/USS_Scorpion_%28SSN-589%29>{:target="_blank"}
* [5] <https://en.wikipedia.org/wiki/Air_France_Flight_447>{:target="_blank"}
* [6] <https://en.wikipedia.org/wiki/Malaysia_Airlines_Flight_370>{:target="_blank"}
* [7] <https://en.wikipedia.org/wiki/Law_of_total_probability>{:target="_blank"}
* [8] <https://en.wikipedia.org/wiki/Bayes%27_theorem>{:target="_blank"}

**其它精选文章**：

* [基于Redis的分布式锁到底安全吗（下）](https://mp.weixin.qq.com/s?__biz=MzA4NTg1MjM0Mg==&mid=2657261521&idx=1&sn=7bbb80c8fe4f9dff7cd6a8883cc8fc0a&chksm=84479e08b330171e89732ec1460258a85afe73299c263fcc7df3c77cbeac0573ad7211902649#rd)
* [漫谈业务与平台](https://mp.weixin.qq.com/s/gPE2XTqTHaN8Bg7NnfOoBw)
* [漫谈分布式系统、拜占庭将军问题与区块链](https://mp.weixin.qq.com/s?__biz=MzA4NTg1MjM0Mg==&mid=2657261626&idx=1&sn=6b32cc7a7a62bee303a8d1c4952d9031&chksm=844791e3b33018f595efabf6edbaa257dc6c5f7fe705e417b6fb7ac81cd94e48d384a694640f#rd)
* [光年之外的世界](https://mp.weixin.qq.com/s/zUgMSqI8QhhrQ_sy_zhzKg)
* [技术的正宗与野路子](https://mp.weixin.qq.com/s?__biz=MzA4NTg1MjM0Mg==&mid=2657261357&idx=1&sn=ebb11a1623e00ca8e6ad55c9ad6b2547#rd)
* [三个字节的历险](https://mp.weixin.qq.com/s?__biz=MzA4NTg1MjM0Mg==&mid=2657261541&idx=1&sn=2f1ea200389d82e7340a5b4103968d7f&chksm=84479e3cb330172a6b2285d4199822143ad05ef8e8c878b98d4ee4f857664c3d15f54e0aab50#rd)
* [做技术的五比一原则](https://mp.weixin.qq.com/s?__biz=MzA4NTg1MjM0Mg==&mid=2657261555&idx=1&sn=3662a2635ecf6f67185abfd697b1057c&chksm=84479e2ab330173cebe16826942b034daec79ded13ee4c03003d7bef262d4969ef0ffb1a0cfb#rd)
* [知识的三个层次](https://mp.weixin.qq.com/s?__biz=MzA4NTg1MjM0Mg==&mid=2657261491&idx=1&sn=cff9bcc4d4cc8c5e642309f7ac1dd5b3&chksm=84479e6ab330177c51bbf8178edc0a6f0a1d56bbeb997ab1cf07d5489336aa59748dea1b3bbc#rd)